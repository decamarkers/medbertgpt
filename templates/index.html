<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MedBert ChatBot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@unocss/runtime"></script>
  <script src="https://code.iconify.design/2/2.0.3/iconify.min.js"></script>
  <script src="https://unpkg.com/htmx.org@1.9.6" integrity="sha384-FhXw7b6AlE/jyjlZH5iHa/tTe9EpJ1Y55RjcgPbjeWMskSxZt1v9qkxLJWNJaGni" crossorigin="anonymous"></script>
  <style></style>
</head>
<body class="m-5">
  <h1>MedBert ChatBot</h1>
  <hr>
  <div id="answer-responses"></div>
  <br>
  <!-- add something that can allow voice -->
  <form hx-post="/process_question" hx-swap="beforeend" hx-target="#answer-responses" class="mb-3">
    <input type="text" id="question-input" name="question" placeholder="Type question here" class="form-control mb-3" x-webkit-speech>
    <button type="button" onclick="recognition.start()" class="btn btn-secondary">
      <span class="iconify" data-icon="carbon:microphone-filled"></span>
    </button>
    <button type="submit" id="question-submit" class="btn btn-primary">Submit</button>
  </form>
  <br>

  <script>
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition
    const recognition = new SpeechRecognition()
    recognition.continuous = true
    recognition.interimResults = true
    let finalTranscript = ""
    recognition.onstart = () => {console.log("Started")}
    recognition.onerror = (e) => {console.error(e)}
    recognition.onend = () => {console.log("Ended")}
    recognition.onresult = (e) => {
      let interimTranscript = ""
      for (let i = e.resultIndex; i < e.results.length; i++) {
        const transcript = event.results[i][0].transcript
        if (event.results[i].isFinal) finalTranscript += transcript
        else interimTranscript += transcript
      }
      finalTranscript += interimTranscript
    }
    console.log(finalTranscript)
  </script>
</body>
</html>